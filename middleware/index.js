const { verifyToken } = require("../utils/verify")


module.exports.auth = async (req, res, next) => {
   const token = await req.header('Auth-Token')
   if(!token) return res.status(400).send('Access Denied')

   try {
    const verified =    await verifyToken(token)
    req.user = verified.id
    next()
       
   } catch (error) {
       res.status(400).send('Access Denied')
   }
}